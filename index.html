<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>木人艸 | 報價系統</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #fff; color: #333; }
        .pdf-table th, .pdf-table td { border: 1px solid #000; padding: 6px 8px; font-size: 13px; }
        .header-bg { background-color: #fcf4d9; } /* 模仿 PDF 的淺黃色表頭 */
        .text-alert { color: #d93025; font-size: 12px; }
        input[type="number"] { width: 45px; text-align: center; border: 1px solid #ccc; border-radius: 4px; }
        .no-border-input { border: none; width: 100%; background: transparent; outline: none; }
        @media print { .no-print { display: none; } }
    </style>
</head>
<body class="p-4 md:p-10">

    <div class="max-w-[1000px] mx-auto border-2 border-black p-4 bg-white shadow-lg">
        <div class="flex justify-between items-start mb-4">
            <div class="text-sm">
                <h1 class="text-2xl font-bold tracking-tighter">木人艸</h1>
                <p>服務專線：02-2883-2113</p>
                <p>公司地址：台北市士林區大南路379號</p>
            </div>
            <div class="text-center">
                <h2 class="text-xl font-bold tracking-widest">木人艸股份有限公司</h2>
                <p class="text-sm">台灣良農食材 (會議餐點 ‧ 餐盒 ‧ 蛋糕)</p>
            </div>
            <div class="text-right text-xs">
                <p>修訂版本：2022/08</p>
            </div>
        </div>

        <table class="w-full pdf-table mb-6">
            <tr>
                <td class="header-bg w-24">派單日期</td>
                <td colspan="2"><input type="date" class="no-border-input" value="2025-11-04"></td>
                <td class="header-bg w-24">訂單編號</td>
                <td colspan="2">Y_20250909-01</td>
                <td class="header-bg w-24">報價業務</td>
                <td>Yvonne</td>
            </tr>
            <tr>
                <td class="header-bg">送餐日期</td>
                <td colspan="2"><input type="text" placeholder="  月  日" class="no-border-input text-center"></td>
                <td colspan="5" class="text-alert">
                    *早晨加成：開餐於 9:00 以前收 3,500 元<br>
                    *夜間加成：撤場時間 16:30-19:00 加價 1,000 元
                </td>
            </tr>
            <tr>
                <td class="header-bg">進場安排</td>
                <td>進場：<input type="time" class="no-border-input"></td>
                <td>交餐：<input type="time" class="no-border-input"></td>
                <td class="header-bg">停車資訊</td>
                <td colspan="4" class="text-xs text-gray-500">(司機進場務必有大樓地下停車場)</td>
            </tr>
            <tr>
                <td class="header-bg">聯絡人</td>
                <td colspan="2"><input type="text" class="no-border-input"></td>
                <td class="header-bg">手機號碼</td>
                <td colspan="4"><input type="text" class="no-border-input"></td>
            </tr>
            <tr>
                <td class="header-bg">送餐地址</td>
                <td colspan="7"><input type="text" placeholder="司機不上樓，須請一樓取餐" class="no-border-input"></td>
            </tr>
        </table>

        <h3 class="text-center font-bold mb-2">訂購餐點明細</h3>
        <table class="w-full pdf-table mb-6">
            <thead>
                <tr class="header-bg text-center">
                    <th class="w-20">產品類別</th>
                    <th>中文餐點名稱</th>
                    <th class="w-16">盒數</th>
                    <th class="w-20">份數/盒</th>
                    <th class="w-20">單價/盒</th>
                    <th class="w-24">小計</th>
                    <th>備註</th>
                </tr>
            </thead>
            <tbody id="menu-body">
                </tbody>
        </table>

        <div class="flex flex-col md:flex-row justify-between gap-4">
            <div class="flex-1 text-xs space-y-2 border p-3 border-gray-300">
                <p class="font-bold">【注意事項】</p>
                <p>1. 建議勿於室溫下放置超過 2 小時，夏天(室溫 > 32℃)勿超過 1 小時。</p>
                <p>2. 需於餐會前兩週支付七成定金款項，尾款需於結束後一週內匯款。</p>
                <p>3. 刷卡需支付手續費 5% [cite: 34]。</p>
            </div>
            <div class="w-full md:w-80">
                <table class="w-full pdf-table">
                    <tr>
                        <td class="header-bg">餐點小計</td>
                        <td class="text-right" id="food-subtotal">$0</td>
                    </tr>
                    <tr>
                        <td class="header-bg">台北市交通費</td>
                        <td class="text-right">$1,500</td>
                    </tr>
                    <tr>
                        <td class="header-bg">營業稅 (5%)</td>
                        <td class="text-right" id="tax-amount">$0</td>
                    </tr>
                    <tr class="font-bold text-lg">
                        <td class="header-bg">總計</td>
                        <td class="text-right text-red-600" id="grand-total">$0</td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="mt-8 flex gap-4 no-print">
            <button onclick="submitToMake()" class="bg-black text-white px-6 py-2 rounded font-bold hover:bg-gray-800">
                提交訂單 (JSON)
            </button>
            <button onclick="window.print()" class="bg-gray-200 text-black px-6 py-2 rounded font-bold hover:bg-gray-300">
                列印 / 存成 PDF
            </button>
        </div>
    </div>

    <script>
        // 從 PDF 提取的完整數據清單
        const products = [
            { id: 'A0100204', cat: '小食', name: '照燒風味迷你漢堡(牛肉)', unit: 15, price: 1350, note: '中盒' },
            { id: 'A0100202', cat: '小食', name: '鹽麴雞肉墨西哥捲餅', unit: 22, price: 1650, note: '中盒' },
            { id: '302001003', cat: '小食', name: '綜合花壽司', unit: 48, price: 960, note: '可葷素/中盒' },
            { id: '301001005', cat: '甜點', name: '迷你棉花糖酸甜檸檬塔(蛋奶素)', unit: 24, price: 1440, note: '中盒' },
            { id: 'A05018010', cat: '甜點', name: '放牧雞蛋肉桂布丁麵包', unit: 28, price: 1400, note: '中盒' },
            { id: '301003004', cat: '甜點', name: '繽紛馬卡龍(蛋奶素)', unit: 28, price: 840, note: '中盒' },
            { id: 'A09001003', cat: '飲品', name: '有機蜜香紅茶(冰)', unit: 1, price: 1000, note: '8公升/桶' }
        ];

        const menuBody = document.getElementById('menu-body');
        let cart = {};

        function initMenu() {
            products.forEach(p => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="text-center text-xs">${p.cat}</td>
                    <td>${p.name}</td>
                    <td class="text-center"><input type="number" value="0" min="0" onchange="updateQty('${p.id}', this.value)"></td>
                    <td class="text-center">${p.unit}</td>
                    <td class="text-right">${p.price.toLocaleString()}</td>
                    <td class="text-right" id="sub-${p.id}">0</td>
                    <td class="text-xs text-gray-500">${p.note}</td>
                `;
                menuBody.appendChild(tr);
            });
        }

        function updateQty(id, qty) {
            qty = parseInt(qty) || 0;
            const product = products.find(p => p.id === id);
            const subtotal = qty * product.price;
            document.getElementById(`sub-${id}`).innerText = subtotal.toLocaleString();
            cart[id] = { qty, subtotal, name: product.name };
            calculateTotal();
        }

        function calculateTotal() {
            let foodTotal = 0;
            Object.values(cart).forEach(item => foodTotal += item.subtotal);
            
            const transFee = foodTotal > 0 ? 1500 : 0;
            const tax = Math.round((foodTotal + transFee) * 0.05);
            const grandTotal = foodTotal + transFee + tax;

            document.getElementById('food-subtotal').innerText = `$${foodTotal.toLocaleString()}`;
            document.getElementById('tax-amount').innerText = `$${tax.toLocaleString()}`;
            document.getElementById('grand-total').innerText = `$${grandTotal.toLocaleString()}`;
        }

        function submitToMake() {
            const data = {
                order_id: "Y_20250909-01",
                customer_info: {
                    delivery_date: document.querySelector('input[type="date"]').value,
                    address: document.querySelector('input[placeholder*="司機不上樓"]').value
                },
                items: Object.entries(cart).map(([id, val]) => ({ id, ...val })),
                total_amount: document.getElementById('grand-total').innerText
            };
            console.log("導出 JSON 資料給 Make.com:", data);
            alert("資料已生成於 Console，可進行自動化串接！");
        }

        initMenu();
    </script>
</body>
</html>
